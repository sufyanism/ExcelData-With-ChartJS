<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Excel Data - Chart.js</title>
<!-- Chart.js CDN -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<!-- xlsx library CDN -->
<script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
<style>
  body {
    font-family: Arial, sans-serif;
    margin: 40px;
    text-align: center;
  }
  #chartContainer {
    width: 90%;
    max-width: 900px;
    margin: auto;
  }
  canvas {
    background: #f9f9f9;
    border: 1px solid #ccc;
  }

  /* Heading */

/* === BASE HEADING === */ 

h1 {
  position: relative;
  padding: 0;
  margin: 0;
  font-family: "Raleway", sans-serif;
  font-weight: 300;
  font-size: 32px;
  color: #080808;
  -webkit-transition: all 0.4s ease 0s;
  -o-transition: all 0.4s ease 0s;
  transition: all 0.4s ease 0s;
}

h1 span {
  display: block;
  font-size: 0.5em;
  line-height: 1.3;
}
h1 em {
  font-style: normal;
  font-weight: 600;
}

/* === HEADING STYLE #1 === */
.one{
    padding-bottom: 20px;
}
.one p {
  font-size: 20px;
}
.one h1 {
  text-align: center;
  padding-bottom: 5px;
}
.one h1:before {
  width: 28px;
  height: 5px;
  display: block;
  content: "";
  position: absolute;
  bottom: 3px;
  left: 50%;
  margin-left: -14px;
  background-color: #b80000;
}
.one h1:after {
  width: 100px;
  height: 1px;
  display: block;
  content: "";
  position: relative;
  margin-top: 25px;
  left: 50%;
  margin-left: -50px;
  background-color: #b80000;
}
</style>
</head>
<body>
  <div class="one">
<h1> Representing Excel Data with Two Datasets  </h1>
<p> zeba.academy </p>
</div>

<div id="chartContainer">
  <canvas id="myChart" width="900" height="500"></canvas>
</div>
<script>
  const excelUrl = 'Dummy.xlsx'; // Replace with your actual URL

  fetch(excelUrl)
    .then(response => response.arrayBuffer())
    .then(data => {
      const workbook = XLSX.read(data, {type: 'array'});
      const sheetName = workbook.SheetNames[0];
      const worksheet = workbook.Sheets[sheetName];

      const jsonData = XLSX.utils.sheet_to_json(worksheet, {header:1});
      const headers = jsonData[0]; // e.g., ['Label', 'Dataset1', 'Dataset2']
      const dataRows = jsonData.slice(1);

      const labels = [];
      const dataset1 = [];
      const dataset2 = [];


      dataRows.forEach(row => {
        labels.push(row[0]);
        dataset1.push(+row[1]);
        dataset2.push(+row[2]);

      });

      const ctx = document.getElementById('myChart').getContext('2d');

      const myChart = new Chart(ctx, {
        type: 'bar',
        data: {
          labels: labels,
          datasets: [
            {
              label: headers[1] || 'Dataset 1',
              data: dataset1,
              backgroundColor: 'rgba(54, 162, 235, 0.7)', // blue
              borderColor: 'rgba(54, 162, 235, 1)',
              borderWidth: 1,
              barThickness: 40,
              borderRadius: 5,
              stack: 'Stack 0'
            },
            {
              label: headers[2] || 'Dataset 2',
              data: dataset2,
              backgroundColor: 'rgba(255, 159, 64, 0.7)', // orange
              borderColor: 'rgba(255, 159, 64, 1)',
              borderWidth: 1,
              barThickness: 40,
              borderRadius: 5,
              stack: 'Stack 0'
            },
          ]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: {
              display: true,
              // position: 'top',
              labels: {
                boxWidth: 20,
                padding: 15,
                color: '#333',
                font: {
                  size: 14,
                  weight: 'bold'
                }
              }
            },
            tooltip: {
              enabled: true,
              backgroundColor: 'rgba(0,0,0,0.7)',
              titleColor: '#fff',
              bodyColor: '#fff',
              borderColor: '#333',
              borderWidth: 1,
              padding: 10,
              displayColors: false,
              callbacks: {
                label: function(context) {
                  return context.dataset.label + ': ' + context.parsed.y;
                }
              }
            },
            title: {
              display: true,
              text: 'Two Datasets',
              font: {
                size: 18,
                weight: 'bold'
              }
            }
          },
          scales: {
            x: {
              title: {
                display: true,
                text: headers[0] || 'Label',
                font: {
                  size: 16,
                  weight: 'bold'
                }
              },
              grid: {
                display: false
              }
            },
            y: {
              beginAtZero: true,
              title: {
                display: true,
                text: 'Score',
                font: {
                  size: 16,
                  weight: 'bold'
                }
              },
              grid: {
                color: 'rgba(0,0,0,0.1)',
                borderDash: [5, 5]
              }
            }
          },
          animation: {
            duration: 1500,
            easing: 'easeOutQuart'
          },
          layout: {
            padding: {
              // top: 10,
              // bottom: 10,
              // left: 10,
              // right: 10
            }
          }
        }
      });
    })
    .catch(error => {
      console.error('Error fetching or processing Excel:', error);
    });
</script>
</body>
</html>